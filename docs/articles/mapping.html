<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mapping with mapboxapi • mapboxapi</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/readable/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Mapping with mapboxapi">
<meta property="og:description" content="mapboxapi">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mapboxapi</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.5.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/mapping.html">Mapping with mapboxapi</a>
    </li>
    <li>
      <a href="../articles/navigation.html">Using navigation services with mapboxapi</a>
    </li>
    <li>
      <a href="../articles/creating-tiles.html">Creating and uploading Mapbox vector tilesets</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/walkerke/mapboxapi">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="mapping_files/htmlwidgets-1.5.1/htmlwidgets.js"></script><script src="mapping_files/jquery-1.12.4/jquery.min.js"></script><link href="mapping_files/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="mapping_files/leaflet-1.3.1/leaflet.js"></script><link href="mapping_files/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="mapping_files/Proj4Leaflet-1.0.1/proj4-compressed.js"></script><script src="mapping_files/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="mapping_files/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="mapping_files/leaflet-binding-2.0.3/leaflet.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Mapping with mapboxapi</h1>
            
      
      
      <div class="hidden name"><code>mapping.Rmd</code></div>

    </div>

    
    
<p>While <strong>mapboxapi</strong> is not an interface to <a href="https://docs.mapbox.com/mapbox-gl-js/api/">Mapbox GL JS</a>, the Mapbox JavaScript library for web mapping, it does have functionality for map-making and visualization in combination with your spatial analysis workflows.</p>
<div id="interactive-and-static-mapping-with-mapbox-styles" class="section level2">
<h2 class="hasAnchor">
<a href="#interactive-and-static-mapping-with-mapbox-styles" class="anchor"></a>Interactive and static mapping with Mapbox styles</h2>
<p>Let’s say that you’ve designed a custom map style in Mapbox Studio that you’d like to incorporate into your R projects. In this example, I’ll use Mapbox’s <a href="https://apps.mapbox.com/cartogram/">Cartogram tool</a> to generate a custom map style from the R logo.</p>
<p><img src="img/cartogram.png" style="width: 800px"></p>
<p>I can retrieve the style ID from my Mapbox account, or use the <code><a href="../reference/list_styles.html">list_styles()</a></code> function in <strong>mapboxapi</strong> to get the ID. With the style ID and my Mapbox username, the <code><a href="../reference/addMapboxTiles.html">addMapboxTiles()</a></code> function allows for direct incorporation of this style in an R Leaflet project.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">leaflet</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">mapboxapi</span>)

<span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/leaflet.html">leaflet</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/addMapboxTiles.html">addMapboxTiles</a></span>(<span class="kw">style_id</span> <span class="kw">=</span> <span class="st">"ckb83x2ur02oa1hpiq9zdt1i2"</span>,
                 <span class="kw">username</span> <span class="kw">=</span> <span class="st">"kwalkertcu"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-methods.html">setView</a></span>(<span class="kw">lng</span> <span class="kw">=</span> -<span class="fl">74.0051</span>,
          <span class="kw">lat</span> <span class="kw">=</span> <span class="fl">40.7251</span>,
          <span class="kw">zoom</span> <span class="kw">=</span> <span class="fl">13</span>)</pre></body></html></div>
<div id="htmlwidget-83975b5bcd2fac793d59" style="width:700px;height:432.632880098888px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-83975b5bcd2fac793d59">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://api.mapbox.com/styles/v1/kwalkertcu/ckb83x2ur02oa1hpiq9zdt1i2/tiles/{z}/{x}/{y}?access_token=pk.eyJ1Ijoia3dhbGtlcnRjdSIsImEiOiJMRk9JSmRvIn0.l1y2jHZ6IARHM_rA1-X45A",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"© <a href=\"https://www.mapbox.com/about/maps/\">Mapbox<\/a> © <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap<\/a> <strong><a href=\"https://www.mapbox.com/map-feedback/\" target=\"_blank\">Improve this map<\/a><\/strong>"}]}],"setView":[[40.7251,-74.0051],13,[]]},"evals":[],"jsHooks":[]}</script><p>In some cases, you may be more interested in a static map rather than an interactive one. Static maps can be generated in <strong>mapboxapi</strong> with the <code><a href="../reference/static_mapbox.html">static_mapbox()</a></code> function. This function accepts sf polygon/linestring (of limited size) or marker overlays.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">points_of_interest</span> <span class="kw">&lt;-</span> <span class="kw pkg">tibble</span><span class="kw ns">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span>(
  <span class="kw">longitude</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">73.99405</span>, -<span class="fl">74.00616</span>, -<span class="fl">73.99577</span>, -<span class="fl">74.00761</span>),
  <span class="kw">latitude</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">40.72033</span>, <span class="fl">40.72182</span>, <span class="fl">40.71590</span>, <span class="fl">40.71428</span>)
  )

<span class="no">prepped_pois</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/prep_overlay_markers.html">prep_overlay_markers</a></span>(
  <span class="kw">data</span> <span class="kw">=</span> <span class="no">points_of_interest</span>,
  <span class="kw">marker_type</span> <span class="kw">=</span> <span class="st">"pin-l"</span>,
  <span class="kw">label</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">4</span>,
  <span class="kw">color</span> <span class="kw">=</span> <span class="st">"fff"</span>
)

<span class="no">map</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/static_mapbox.html">static_mapbox</a></span>(
  <span class="kw">style_id</span> <span class="kw">=</span> <span class="st">"ckb83x2ur02oa1hpiq9zdt1i2"</span>,
  <span class="kw">username</span> <span class="kw">=</span> <span class="st">"kwalkertcu"</span>,
  <span class="kw">overlay_markers</span> <span class="kw">=</span> <span class="no">prepped_pois</span>,
  <span class="kw">width</span> <span class="kw">=</span> <span class="fl">1200</span>,
  <span class="kw">height</span> <span class="kw">=</span> <span class="fl">800</span>
)

<span class="no">map</span></pre></body></html></div>
<p><img src="mapping_files/figure-html/unnamed-chunk-2-1.png" width="600"></p>
<p>The output is an object from the <a href="https://github.com/ropensci/magick">magick</a> R package that can be further customized with <strong>magick</strong> functions.</p>
</div>
<div id="reading-vector-tile-data-into-r" class="section level2">
<h2 class="hasAnchor">
<a href="#reading-vector-tile-data-into-r" class="anchor"></a>Reading vector tile data into R</h2>
<p>Mapbox styles on interactive maps are generally delivered as vector tiles, and can be visualized in this way in R with the <a href="https://symbolixau.github.io/mapdeck/articles/mapdeck.html">mapdeck R package</a> by providing style information obtained from Mapbox Studio. <strong>mapboxapi</strong> also allows you to read data from vector tilesets directly into R as sf objects.</p>
<p>For example, let’s say I want to grab data from a vector tileset nearby to one of the points of interest I just mapped. This can be accomplished with the <code><a href="../reference/get_vector_tiles.html">get_vector_tiles()</a></code> function and an appropriate tileset ID, which can be obtained from your Mapbox account. The location to query can be a coordinate pair, an address, or an sf object.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">vector_extract</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/get_vector_tiles.html">get_vector_tiles</a></span>(
  <span class="kw">tileset_id</span> <span class="kw">=</span> <span class="st">"mapbox.mapbox-streets-v8"</span>,
  <span class="kw">location</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">73.99405</span>, <span class="fl">40.72033</span>),
  <span class="kw">zoom</span> <span class="kw">=</span> <span class="fl">15</span>
)

<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">vector_extract</span>)</pre></body></html></div>
<pre><code>## [1] "landuse"            "water"              "structure"         
## [4] "building"           "road"               "place_label"       
## [7] "transit_stop_label" "natural_label"      "poi_label"</code></pre>
<p>I get back a number of layers, including roads, labels, and buildings, from the vector tile at zoom 15 that intersects my input coordinates. All of these elements are processed as sf objects that can be mapped with R tools:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">vector_extract</span>$<span class="no">building</span>$<span class="no">polygons</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span>()</pre></body></html></div>
<p><img src="mapping_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Kyle Walker.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
